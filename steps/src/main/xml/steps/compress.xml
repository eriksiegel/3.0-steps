<section xmlns="http://docbook.org/ns/docbook" xmlns:p="http://www.w3.org/ns/xproc"
  xmlns:e="http://www.w3.org/1999/XSL/Spec/ElementSyntax" xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="c.compress">

  <title>p:compress</title>

  <para>The <code>p:compress</code> step serializes the document appearing on its
      <code>source</code> port and outputs a compressed version of this on its <port>result</port>
    port.</para>

  <p:declare-step type="p:compress">
    <p:input port="source" primary="true" content-types="any" sequence="false"/>
    <p:output port="result" primary="true" content-types="any" sequence="false"/>
    <p:option name="format" as="xs:QName"/>
    <p:option name="serialization" as="map(xs:QName,item()*)?"/>
    <p:option name="parameters" as="map(xs:Qname, item()*)?"/>
  </p:declare-step>

  <para>The <code>p:compress</code> step first serializes the document appearing on its
      <code>source</code>. It then compresses the result of this serialization and outputs the
    result on its <code>result</code> port.</para>

  <para>The <code>p:compress</code> step has the following options:</para>
  <variablelist>
    <varlistentry>
      <term><option>format</option></term>
      <listitem>
        <para>The compression format can be specified using the <option>format</option> option.
          Implementations <rfc2119>must</rfc2119> support the <!--<biblioref linkend="zip"/>--> TBD
          format, specified with the value <code>TBD</code>. <impl>It is
              <glossterm>implementation-defined</glossterm> what other formats are
          supported.</impl></para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><option>parameters</option></term>
      <listitem>
        <para>The <option>parameters</option> option can be used to supply parameters to control the
          compression. <impl>The semantics of the keys and the allowed values for these keys are
              <glossterm>implementation-defined</glossterm>.</impl>
          <error code="C0079">It is a <glossterm>dynamic error</glossterm> if the map
              <option>parameters</option> contains an entry whose key is defined by the
            implementation and whose value is not valid for that key.</error></para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><option>serialization</option></term>
      <listitem>
        <para>This step supports the standard serialization options as specified in <link
            linkend="xml-serialization-31"/>. These options control how serialization is done before
          the compression takes place.</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

  <simplesect>
    <title>Document properties</title>
    <para feature="compress-preserves-some">All document properties are preserved except the
        <code>content-type</code> property which is updated accordingly.</para>
  </simplesect>

</section>
